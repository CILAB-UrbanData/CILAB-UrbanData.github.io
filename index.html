<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Urban Datasets - Research-Grade Urban Data</title>
    <meta name="description" content="Comprehensive collection of urban mobility and transportation datasets for research, machine learning, and policy analysis.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            900: '#0f172a'
                        },
                        accent: {
                            500: '#8b5cf6',
                            600: '#7c3aed'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white text-gray-900 font-sans">
     <!-- Navigation  -->
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <a href="/" class="text-xl font-bold text-primary-900">Urban Datasets</a>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="/" class="text-gray-700 hover:text-primary-600 transition-colors">Home</a>
                    <a href="/datasets/" class="text-gray-700 hover:text-primary-600 transition-colors">Browse Datasets</a>
                    <!-- <a href="/datasets/overview/" class="text-gray-700 hover:text-primary-600 transition-colors">Overview</a> -->
                </div>
                <button id="mobile-menu-btn" class="md:hidden p-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
         <!-- Mobile menu  -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-200">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="/" class="block px-3 py-2 text-gray-700 hover:text-primary-600">Home</a>
                <a href="/datasets/" class="block px-3 py-2 text-gray-700 hover:text-primary-600">Browse Datasets</a>
                <a href="/datasets/overview/" class="block px-3 py-2 text-gray-700 hover:text-primary-600">Overview</a>
            </div>
        </div>
    </nav>

     <!-- Hero Section  -->
    <section class="bg-gradient-to-br from-primary-50 to-accent-50 py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl md:text-6xl font-bold text-primary-900 mb-6 text-balance">
                Research-Grade Urban Datasets
            </h1>
            <p class="text-xl text-primary-600 mb-8 max-w-3xl mx-auto text-pretty">
                Comprehensive collection of transportation and mobility datasets from cities worldwide. 
                Ready for research, machine learning, and policy analysis.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="/datasets/" class="bg-accent-500 text-white px-8 py-3 rounded-lg font-semibold hover:bg-accent-600 transition-colors">
                    Browse Datasets
                </a>
                <!-- <a href="/datasets/overview/" class="bg-white text-primary-700 px-8 py-3 rounded-lg font-semibold border border-primary-200 hover:bg-primary-50 transition-colors">
                    View Overview
                </a> -->
            </div>
        </div>
    </section>

     <!-- Quick Stats  -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <div class="text-center">
                    <div id="stat-datasets" class="text-3xl font-bold text-accent-500 mb-2">0</div>
                    <div class="text-gray-600">Datasets</div>
                </div>

                <div class="text-center">
                    <div id="stat-cities" class="text-3xl font-bold text-accent-500 mb-2">0</div>
                    <div class="text-gray-600">Cities</div>
                </div>

                <div class="text-center">
                    <div id="stat-years" class="text-3xl font-bold text-accent-500 mb-2">0</div>
                    <div class="text-gray-600">Years</div>
                </div>

                <div class="text-center">
                    <div id="stat-total" class="text-3xl font-bold text-accent-500 mb-2">0</div>
                    <div class="text-gray-600">Total Data</div>
                </div>
            </div>
        </div>
    </section>

     <!-- Featured Datasets  -->
    <section class="py-16 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-primary-900 mb-12 text-center">Featured Datasets</h2>
            <div id="featured-datasets" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8"></div>           
        </div>
    </section>

     <!-- Footer  -->
    <footer class="bg-primary-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-lg font-semibold mb-4">Urban Datasets</h3>
                    <p class="text-primary-300">Research-grade transportation and mobility datasets for academic and commercial use.</p>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">Quick Links</h4>
                    <ul class="space-y-2 text-primary-300">
                        <li><a href="/datasets/" class="hover:text-white transition-colors">Browse Datasets</a></li>
                        <li><a href="/datasets/overview/" class="hover:text-white transition-colors">Dataset Overview</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">Contact</h4>
                    <p class="text-primary-300">For questions about datasets or licensing, please contact our research team.</p>
                </div>
            </div>
            <div class="border-t border-primary-700 mt-8 pt-8 text-center text-primary-300">
                <p>&copy; 2024 Urban Datasets. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        document.getElementById('mobile-menu-btn').addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });
    </script>

    <script>
    async function loadHomeData() {
        try {
            // 1. 读取 /datasets/index.html 页面
            const res = await fetch('/datasets/index.html');
            const text = await res.text();

            // 2. 从里面用正则提取 const datasets = [ ... ];
            const match = text.match(/const datasets = (\[.*?\]);/s);
            if (!match) {
                console.error('Cannot find datasets array in /datasets/index.html');
                return;
            }

            // 3. 解析成 JS 数组（你控制文件内容，这里用 eval 可以接受）
            const datasets = eval(match[1]);

            // =======================
            // A. 更新 Quick Stats
            // =======================
            const datasetCount = datasets.length;
            const cityCount    = new Set(datasets.map(d => d.city)).size;
            const yearCount    = new Set(datasets.map(d => d.created.slice(0, 4))).size;
            const totalBytes   = datasets.reduce((acc, d) => acc + d.sizeBytes, 0);

            function formatBytes(x) {
                if (x > 1e12) return (x / 1e12).toFixed(1) + 'TB';
                if (x > 1e9)  return (x / 1e9).toFixed(1)  + 'GB';
                if (x > 1e6)  return (x / 1e6).toFixed(1)  + 'MB';
                return x + 'B';
            }

            const totalData = formatBytes(totalBytes);

            const elDatasets = document.getElementById('stat-datasets');
            const elCities   = document.getElementById('stat-cities');
            const elYears    = document.getElementById('stat-years');
            const elTotal    = document.getElementById('stat-total');

            if (elDatasets && elCities && elYears && elTotal) {
                elDatasets.textContent = datasetCount;
                elCities.textContent   = cityCount;
                elYears.textContent    = yearCount;
                elTotal.textContent    = totalData;
            }

            // =======================
            // B. 更新 Featured Datasets（最新 3 个）
            // =======================
            const container = document.getElementById('featured-datasets');
            if (!container) return;

            // 按 created 时间从新到旧排序
            const sorted = [...datasets].sort(
                (a, b) => new Date(b.created) - new Date(a.created)
            );
            const top3 = sorted.slice(0, 3);

            const cardsHtml = top3.map(dataset => {
                const statusColor = dataset.status === 'Active' ? 'green' : 'red';
                const tagsHtml = (dataset.tags || []).slice(0, 3).map(tag => `
                    <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">${tag}</span>
                `).join('');

                return `
                    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow">
                        <div class="flex items-center justify-between mb-4">
                            <span class="bg-${statusColor}-100 text-${statusColor}-800 text-xs font-medium px-2.5 py-0.5 rounded">
                                ${dataset.status}
                            </span>
                            <span class="text-sm text-gray-500">${dataset.size}</span>
                        </div>
                        <h3 class="text-xl font-semibold text-primary-900 mb-2">${dataset.title}</h3>
                        <p class="text-gray-600 mb-4">${dataset.description}</p>
                        <div class="flex flex-wrap gap-2 mb-4">
                            ${tagsHtml}
                        </div>
                        <a href="/datasets/${dataset.id}/" class="text-accent-500 hover:text-accent-600 font-medium">
                            View Details →
                        </a>
                    </div>
                `;
            }).join('');

            container.innerHTML = cardsHtml;

        } catch (err) {
            console.error('Failed to load home data:', err);
        }
    }

    // 页面加载后执行
    loadHomeData();
    </script>

</body>
</html>
